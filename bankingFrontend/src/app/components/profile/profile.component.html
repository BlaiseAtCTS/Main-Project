<div class="container mx-auto px-4 py-8">
  @if (profileQuery.isPending()) {
  <div class="flex justify-center items-center h-64">
    <div class="spinner"></div>
    <p class="loading-text">Loading your profile...</p>
  </div>
  } @if (profileQuery.error()) {
  <div class="alert alert-error">
    {{ profileQuery.error()?.message || 'An error occurred while loading your profile.' }}
  </div>
  } @if (profileQuery.data()) {
  <div class="profile-container">
    <div class="profile-header">
      <h2 class="profile-title">Profile Information</h2>
    </div>

    <div class="profile-grid">
      <!-- Personal Details Section -->
      <div class="profile-section">
        <h3 class="section-title">Personal Details</h3>
        <div class="details-list">
          <!-- Full Name -->
          <div class="detail-item">
            <div class="detail-icon">üë§</div>
            <div class="detail-content">
              <label class="detail-label">Full Name</label>
              <div class="detail-value">
                {{ profileQuery.data()?.firstName }} {{ profileQuery.data()?.lastName }}
              </div>
            </div>
          </div>

          <!-- Username -->
          <div class="detail-item">
            <div class="detail-icon">üîñ</div>
            <div class="detail-content">
              <label class="detail-label">Username</label>
              <div class="detail-value">{{ profileQuery.data()?.userName }}</div>
            </div>
          </div>

          <!-- Email -->
          <div class="detail-item">
            <div class="detail-icon">üìß</div>
            <div class="detail-content">
              <label class="detail-label">Email</label>
              <div class="detail-value">{{ profileQuery.data()?.email || 'Not provided' }}</div>
            </div>
          </div>

          <!-- Phone Number -->
          <div class="detail-item">
            <div class="detail-icon">üì±</div>
            <div class="detail-content">
              <label class="detail-label">Phone Number</label>
              <div class="detail-value">{{ profileQuery.data()?.phoneNumber || 'Not provided' }}</div>
            </div>
          </div>

          <!-- Date of Birth -->
          <div class="detail-item">
            <div class="detail-icon">üéÇ</div>
            <div class="detail-content">
              <label class="detail-label">Date of Birth</label>
              <div class="detail-value">{{ formatDate(profileQuery.data()?.dob) }}</div>
            </div>
          </div>

          <!-- Address -->
          <div class="detail-item">
            <div class="detail-icon">üìç</div>
            <div class="detail-content">
              <label class="detail-label">Address</label>
              <div class="detail-value">{{ profileQuery.data()?.address || 'Not provided' }}</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Accounts Section -->
      <div class="profile-section">
        <h3 class="section-title">Accounts</h3>
        <div class="accounts-list">
          @for (account of profileQuery.data()?.accounts || []; track account.accountNumber) {
          <div class="account-card">
            <div class="account-header">
              <div class="account-type-badge">{{ account.type }}</div>
            </div>
            <div class="account-info">
              <div class="account-number-label">Account Number</div>
              <div class="account-number">{{ account.accountNumber }}</div>
            </div>
            <div class="account-balance-section">
              <div class="balance-label">Current Balance</div>
              <div class="balance-amount" 
                   [class.low-balance]="account.balance !== null && account.balance < 1000">
                ${{ account.balance != null ? (account.balance | number : '1.2-2') : '0.00' }}
              </div>
              @if (account.balance !== null && account.balance < 1000) {
                <div class="low-balance-badge">‚ö†Ô∏è Low Balance</div>
              }
            </div>
          </div>
          }
          @if (!profileQuery.data()?.accounts || (profileQuery.data()?.accounts && profileQuery.data()!.accounts.length === 0)) {
            <div class="no-accounts">
              <div class="no-accounts-icon">üè¶</div>
              <p>No accounts found</p>
            </div>
          }
        </div>
      </div>
    </div>
  </div>
  }
</div>
