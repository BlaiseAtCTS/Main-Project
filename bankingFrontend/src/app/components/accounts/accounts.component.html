<div class="min-h-screen bg-gray-50">
  <header class="bg-white shadow">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center py-6">
        <div class="flex items-center">
          <button (click)="goBack()" class="mr-4 text-gray-500 hover:text-gray-700">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
            </svg>
          </button>
          <h1 class="text-2xl font-bold text-gray-900">Account Management</h1>
        </div>
      </div>
    </div>
  </header>

  <main class="max-w-7xl mx-auto py-6 sm:px-6 lg:px-8">
    <div class="px-4 py-6 sm:px-0">
      <div class="border-b border-gray-200 mb-8">
        <nav class="-mb-px flex space-x-8">
          <button (click)="setActiveTab('create')" [class]=" activeTab === 'create' ? 'border-primary-500 text-primary-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300' " class="whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"> Create Account </button>
          <button (click)="setActiveTab('deposit')" [class]=" activeTab === 'deposit' ? 'border-primary-500 text-primary-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300' " class="whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"> Deposit </button>
          <button (click)="setActiveTab('withdraw')" [class]=" activeTab === 'withdraw' ? 'border-primary-500 text-primary-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300' " class="whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"> Withdraw </button>
          <button (click)="setActiveTab('balance')" [class]=" activeTab === 'balance' ? 'border-primary-500 text-primary-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300' " class="whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"> Check Balance </button>
          <button (click)="setActiveTab('delete')" [class]=" activeTab === 'delete' ? 'border-primary-500 text-primary-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300' " class="whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"> Delete Account </button>
        </nav>
      </div>

      <!-- Messages -->
      @if (createAccountMutation.error() || depositMutation.error() || withdrawMutation.error() ||
      balanceMutation.error() || deleteAccountMutation.error()) {
      <div class="mb-6 bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-lg">
        {{
          createAccountMutation.error()?.message ||
            depositMutation.error()?.message ||
            withdrawMutation.error()?.message ||
            balanceMutation.error()?.message ||
            deleteAccountMutation.error()?.message
        }}
      </div>
      } @if (createAccountMutation.data()?.success || depositMutation.data()?.success ||
      withdrawMutation.data()?.success || deleteAccountMutation.data()?.success) {
      <div class="mb-6 bg-green-50 border border-green-200 text-green-600 px-4 py-3 rounded-lg">
        {{
          createAccountMutation.data()?.message ||
            depositMutation.data()?.message ||
            withdrawMutation.data()?.message ||
            deleteAccountMutation.data()?.message
        }}
      </div>
      }

      <div
        *ngIf="balanceResult"
        class="mb-6 bg-blue-50 border border-blue-200 text-blue-600 px-4 py-3 rounded-lg"
      >
        {{ balanceResult }}
      </div>

      <div *ngIf="activeTab === 'create'" class="card p-6">
        <h2 class="text-xl font-semibold text-gray-900 mb-4">Create New Account</h2>
        <form (ngSubmit)="createAccount()" #createForm="ngForm">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
            <div>
              <label for="accountNumber" class="block text-sm font-medium text-gray-700">Account Number</label>
              <input id="accountNumber" name="accountNumber" type="text" required [(ngModel)]="newAccount.accountNumber" class="input-field mt-1" placeholder="Enter account number" />
            </div>
            <div>
              <label for="accountType" class="block text-sm font-medium text-gray-700">Account Type</label>
              <select id="accountType" name="accountType" required [(ngModel)]="newAccount.type" class="input-field mt-1">
                <option value="SAVINGS">Savings</option>
                <option value="CHECKING">Checking</option>
                <option value="BUSINESS">Business</option>
              </select>
            </div>
          </div>
          <div class="mb-4">
            <label for="initialBalance" class="block text-sm font-medium text-gray-700">Initial Balance</label>
            <input id="initialBalance" name="initialBalance" type="number" min="0" step="0.01" required [(ngModel)]="newAccount.initialBalance" class="input-field mt-1" placeholder="Enter initial balance" />
          </div>
          <button
            type="submit"
            [disabled]="!createForm.form.valid || createAccountMutation.isPending()"
            class="btn-primary"
          >
            <span *ngIf="!createAccountMutation.isPending()">Create Account</span>
            <span *ngIf="createAccountMutation.isPending()">Creating...</span>
          </button>
        </form>
      </div>

      <div *ngIf="activeTab === 'deposit'" class="card p-6">
        <h2 class="text-xl font-semibold text-gray-900 mb-4">Deposit Amount</h2>
        <form (ngSubmit)="depositAmount()" #depositForm="ngForm">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
            <div>
              <label for="depositAccountNumber" class="block text-sm font-medium text-gray-700">Account Number</label>
              <input id="depositAccountNumber" name="depositAccountNumber" type="text" required [(ngModel)]="operationAccount.accountNumber" class="input-field mt-1" placeholder="Enter account number" />
            </div>
            <div>
              <label for="depositAmount" class="block text-sm font-medium text-gray-700">Amount</label>
              <input id="depositAmount" name="depositAmount" type="number" min="0.01" step="0.01" required [(ngModel)]="operationAccount.balance" class="input-field mt-1" placeholder="Enter amount to deposit" />
            </div>
          </div>
          <button
            type="submit"
            [disabled]="!depositForm.form.valid || depositMutation.isPending()"
            class="btn-primary"
          >
            <span *ngIf="!depositMutation.isPending()">Deposit</span>
            <span *ngIf="depositMutation.isPending()">Processing...</span>
          </button>
        </form>
      </div>

      <div *ngIf="activeTab === 'withdraw'" class="card p-6">
        <h2 class="text-xl font-semibold text-gray-900 mb-4">Withdraw Amount</h2>
        <form (ngSubmit)="withdrawAmount()" #withdrawForm="ngForm">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
            <div>
              <label for="withdrawAccountNumber" class="block text-sm font-medium text-gray-700">Account Number</label>
              <input id="withdrawAccountNumber" name="withdrawAccountNumber" type="text" required [(ngModel)]="operationAccount.accountNumber" class="input-field mt-1" placeholder="Enter account number" />
            </div>
            <div>
              <label for="withdrawAmount" class="block text-sm font-medium text-gray-700">Amount</label>
              <input id="withdrawAmount" name="withdrawAmount" type="number" min="0.01" step="0.01" required [(ngModel)]="operationAccount.balance" class="input-field mt-1" placeholder="Enter amount to withdraw" />
            </div>
          </div>
          <button
            type="submit"
            [disabled]="!withdrawForm.form.valid || withdrawMutation.isPending()"
            class="btn-primary"
          >
            <span *ngIf="!withdrawMutation.isPending()">Withdraw</span>
            <span *ngIf="withdrawMutation.isPending()">Processing...</span>
          </button>
        </form>
      </div>

      <div *ngIf="activeTab === 'balance'" class="card p-6">
        <h2 class="text-xl font-semibold text-gray-900 mb-4">Check Account Balance</h2>
        <form (ngSubmit)="checkBalance()" #balanceForm="ngForm">
          <div class="mb-4">
            <label for="balanceAccountNumber" class="block text-sm font-medium text-gray-700">Account Number</label>
            <input id="balanceAccountNumber" name="balanceAccountNumber" type="text" required [(ngModel)]="balanceAccountNumber" class="input-field mt-1" placeholder="Enter account number" />
          </div>
          <button
            type="submit"
            [disabled]="!balanceForm.form.valid || balanceMutation.isPending()"
            class="btn-primary"
          >
            <span *ngIf="!balanceMutation.isPending()">Check Balance</span>
            <span *ngIf="balanceMutation.isPending()">Checking...</span>
          </button>
        </form>
      </div>

      <div *ngIf="activeTab === 'delete'" class="card p-6">
        <h2 class="text-xl font-semibold text-gray-900 mb-4">Delete Account</h2>
        <div class="bg-yellow-50 border border-yellow-200 text-yellow-800 px-4 py-3 rounded-lg mb-4">
          <strong>Warning:</strong> This action cannot be undone. All account data will be permanently deleted.
        </div>
        <form (ngSubmit)="deleteAccount()" #deleteForm="ngForm">
          <div class="mb-4">
            <label for="deleteAccountNumber" class="block text-sm font-medium text-gray-700">Account Number</label>
            <input id="deleteAccountNumber" name="deleteAccountNumber" type="text" required [(ngModel)]="operationAccount.accountNumber" class="input-field mt-1" placeholder="Enter account number to delete" />
          </div>
          <button
            type="submit"
            [disabled]="!deleteForm.form.valid || deleteAccountMutation.isPending()"
            class="bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200"
          >
            <span *ngIf="!deleteAccountMutation.isPending()">Delete Account</span>
            <span *ngIf="deleteAccountMutation.isPending()">Deleting...</span>
          </button>
        </form>
      </div>
    </div>
  </main>
</div>