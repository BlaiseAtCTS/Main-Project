<div class="min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-50">
  <div class="bg-gradient-to-r from-primary-600 to-secondary-600 text-white py-8 px-4 sm:px-6 lg:px-8">
    <div class="max-w-7xl mx-auto">
      <h1 class="text-3xl font-bold">{{ 'TRANSACTIONS.TITLE' | translate }}</h1>
    </div>
  </div>

  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <!-- Status alerts -->
    <ui-alert *ngIf="error()" variant="error" class="mb-4">
      <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
      <span class="ml-2">{{ error() }}</span>
    </ui-alert>
    <ui-alert *ngIf="success()" variant="success" class="mb-4">
      <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>
      <span class="ml-2">{{ success() }}</span>
    </ui-alert>

    <!-- Tabs -->
    <div class="flex gap-2 mb-6">
      <ui-button [variant]="activeTab() === 'transfer' ? 'default' : 'outline'" (click)="setActiveTab('transfer')">{{ 'TRANSACTIONS.TRANSFER_MONEY' | translate }}</ui-button>
      <ui-button [variant]="activeTab() === 'history' ? 'default' : 'outline'" (click)="setActiveTab('history')">{{ 'TRANSACTIONS.TRANSACTION_HISTORY' | translate }}</ui-button>
    </div>

    <!-- Transfer Tab -->
    @if (activeTab() === 'transfer') {
      
        <ui-card class="border-0 bg-white/70 backdrop-blur">
          <ui-card-header class="border-b bg-gradient-to-r from-gray-50 to-white">
            <ui-card-title>{{ 'TRANSACTIONS.TRANSFER_MONEY' | translate }}</ui-card-title>
          </ui-card-header>
          <ui-card-content class="p-6 space-y-4">
            @if (loading()) {
              <div class="flex items-center gap-2 text-gray-600">
                <ui-spinner size="sm"></ui-spinner>
                {{ 'COMMON.LOADING' | translate }}
              </div>
            } @else if (accounts().length === 0) {
              <div class="text-center py-8">
                <svg class="h-10 w-10 text-gray-400 mx-auto mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h10"/></svg>
                <p class="text-gray-600">{{ 'TRANSACTIONS.NO_ACCOUNTS_AVAILABLE' | translate }}</p>
                <div class="mt-3">
                  <ui-button routerLink="/accounts">{{ 'TRANSACTIONS.GO_TO_ACCOUNTS' | translate }}</ui-button>
                </div>
              </div>
            } @else {
              <form (ngSubmit)="onTransfer()" class="space-y-4">
                <div>
                  <label class="block text-sm text-gray-600 mb-1">{{ 'TRANSACTIONS.FROM_ACCOUNT' | translate }}</label>
                  <select class="w-full border rounded px-3 py-2" [value]="transferSourceAccountNumber()" (change)="onTransferSourceAccountChange($any($event.target).value)">
                    @for (account of accounts(); track account.accountNumber) {
                      <option [value]="account.accountNumber">
                        {{ account.accountNumber }} - {{ account.type }} ({{ formatCurrency(account.balance) }})
                      </option>
                    }
                  </select>
                </div>
                @if (selectedTransferSourceAccount()) {
                  <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div class="p-3 border rounded">
                      <p class="text-xs text-gray-500 mb-1">{{ 'TRANSACTIONS.AVAILABLE_BALANCE' | translate }}</p>
                      <p class="font-medium">{{ formatCurrency(selectedTransferSourceAccount()!.balance) }}</p>
                    </div>
                    <div class="p-3 border rounded">
                      <p class="text-xs text-gray-500 mb-1">{{ 'TRANSACTIONS.ACCOUNT_TYPE' | translate }}</p>
                      <p class="font-medium">{{ selectedTransferSourceAccount()!.type }}</p>
                    </div>
                  </div>
                }
                <div>
                  <label class="block text-sm text-gray-600 mb-1">{{ 'TRANSACTIONS.DESTINATION_ACCOUNT' | translate }}</label>
                  <input type="text" class="w-full border rounded px-3 py-2" [placeholder]="'TRANSACTIONS.ENTER_DESTINATION' | translate" [value]="destinationAccountNumber()" (input)="destinationAccountNumber.set($any($event.target).value)" required>
                </div>
                <div>
                  <label class="block text-sm text-gray-600 mb-1">{{ 'TRANSACTIONS.AMOUNT' | translate }}</label>
                  <input type="number" class="w-full border rounded px-3 py-2" placeholder="0.00" min="0.01" step="0.01" [value]="transferAmount()" (input)="transferAmount.set(+$any($event.target).value)" required>
                </div>
                <div>
                  <ui-button type="submit" [disabled]="loading()">{{ loading() ? ('TRANSACTIONS.PROCESSING' | translate) : ('TRANSACTIONS.TRANSFER' | translate) }}</ui-button>
                </div>
              </form>
            }
          </ui-card-content>
        </ui-card>
      
    }

    <!-- History Tab -->
    @if (activeTab() === 'history') {
      <div class="space-y-4">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm text-gray-600 mb-1">{{ 'TRANSACTIONS.ACCOUNT' | translate }}</label>
            <select class="w-full border rounded px-3 py-2" [value]="historyAccountNumber()" (change)="onAccountChange($any($event.target).value)">
              @for (account of accounts(); track account.accountNumber) {
                <option [value]="account.accountNumber">{{ account.accountNumber }} - {{ account.type }}</option>
              }
            </select>
          </div>
          <div>
            <label class="block text-sm text-gray-600 mb-1">{{ 'TRANSACTIONS.SEARCH' | translate }}</label>
            <input type="text" class="w-full border rounded px-3 py-2" [placeholder]="'TRANSACTIONS.SEARCH_TRANSACTIONS' | translate" [value]="searchTerm()" (input)="onSearch($any($event.target).value)">
          </div>
        </div>

        @if (selectedAccount()) {
          
            <ui-card class="border-0 bg-white/70 backdrop-blur">
              <ui-card-content class="p-4 grid grid-cols-1 sm:grid-cols-3 gap-4">
                <div>
                  <p class="text-xs text-gray-500">{{ 'ACCOUNTS.ACCOUNT_NUMBER' | translate }}</p>
                  <p class="font-medium">{{ selectedAccount()!.accountNumber }}</p>
                </div>
                <div>
                  <p class="text-xs text-gray-500">{{ 'ACCOUNTS.TYPE' | translate }}</p>
                  <p class="font-medium">{{ selectedAccount()!.type }}</p>
                </div>
                <div>
                  <p class="text-xs text-gray-500">{{ 'ACCOUNTS.BALANCE' | translate }}</p>
                  <p class="font-medium">{{ formatCurrency(selectedAccount()!.balance) }}</p>
                </div>
              </ui-card-content>
            </ui-card>
          
        }

        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          
            <ui-card class="border-0 bg-white/70 backdrop-blur">
              <ui-card-content class="p-4 text-center">
                <div class="text-sm text-gray-600">{{ 'TRANSACTIONS.TOTAL_DEPOSITS' | translate }}</div>
                <div class="text-2xl font-semibold">{{ formatCurrency(totalDeposits()) }}</div>
              </ui-card-content>
            </ui-card>
          
          
            <ui-card class="border-0 bg-white/70 backdrop-blur">
              <ui-card-content class="p-4 text-center">
                <div class="text-sm text-gray-600">{{ 'TRANSACTIONS.TOTAL_WITHDRAWALS' | translate }}</div>
                <div class="text-2xl font-semibold">{{ formatCurrency(totalWithdrawals()) }}</div>
              </ui-card-content>
            </ui-card>
          
          
            <ui-card class="border-0 bg-white/70 backdrop-blur">
              <ui-card-content class="p-4 text-center">
                <div class="text-sm text-gray-600">{{ 'TRANSACTIONS.TOTAL_TRANSFERS' | translate }}</div>
                <div class="text-2xl font-semibold">{{ formatCurrency(totalTransfers()) }}</div>
              </ui-card-content>
            </ui-card>
          
        </div>

        
          <ui-card class="border-0 bg-white/70 backdrop-blur">
            <ui-card-header class="border-b bg-gradient-to-r from-gray-50 to-white">
              <ui-card-title>{{ 'TRANSACTIONS.TRANSACTION_HISTORY' | translate }}</ui-card-title>
            </ui-card-header>
            <ui-card-content class="p-0">
              @if (loadingTransactions()) {
                <div class="p-6 flex items-center gap-2 text-gray-600">
                  <ui-spinner size="sm"></ui-spinner>
                  {{ 'COMMON.LOADING' | translate }}
                </div>
              } @else if (filteredTransactions().length === 0) {
                <div class="p-6 text-center text-gray-600">
                  {{ 'TRANSACTIONS.NO_TRANSACTIONS' | translate }}
                  @if (searchTerm()) {
                    <div class="text-xs">{{ 'TRANSACTIONS.ADJUST_SEARCH' | translate }}</div>
                  }
                </div>
              } @else {
                <div class="overflow-x-auto">
                  <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                      <tr>
                        <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer" (click)="sortBy('id')">{{ 'TRANSACTIONS.ID' | translate }}</th>
                        <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer" (click)="sortBy('type')">{{ 'TRANSACTIONS.TYPE' | translate }}</th>
                        <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">{{ 'TRANSACTIONS.FROM_ACCOUNT' | translate }}</th>
                        <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">{{ 'TRANSACTIONS.TO_ACCOUNT' | translate }}</th>
                        <th class="px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer" (click)="sortBy('amount')">{{ 'TRANSACTIONS.AMOUNT' | translate }}</th>
                        <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer" (click)="sortBy('timestamp')">{{ 'TRANSACTIONS.DATE_TIME' | translate }}</th>
                      </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                      @for (transaction of filteredTransactions(); track transaction.id) {
                        <tr>
                          <td class="px-4 py-2">#{{ transaction.id }}</td>
                          <td class="px-4 py-2">
                            <span class="px-2 py-1 rounded-full text-xs font-semibold" [ngClass]="{
                              'bg-emerald-50 text-emerald-700': transaction.type === 'Deposit',
                              'bg-rose-50 text-rose-700': transaction.type === 'Withdraw',
                              'bg-blue-100 text-blue-700': transaction.type === 'Transfer'
                            }">{{ transaction.type }}</span>
                          </td>
                          <td class="px-4 py-2">{{ transaction.sourceAccountNumber }}</td>
                          <td class="px-4 py-2">{{ transaction.destinationAccountNumber }}</td>
                          <td class="px-4 py-2 text-right">{{ formatCurrency(transaction.amount) }}</td>
                          <td class="px-4 py-2">{{ formatDate(transaction.timestamp) }}</td>
                        </tr>
                      }
                    </tbody>
                  </table>
                </div>
              }
            </ui-card-content>
          </ui-card>
        
      </div>
    }
  </div>
</div>
